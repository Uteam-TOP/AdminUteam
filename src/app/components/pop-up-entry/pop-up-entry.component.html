<div class="popup-overlay">
  <div class="popup" (click)="$event.stopPropagation()">
    <div class="close-button" (click)="closePopUp()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M5 5L18 18M5.0002 18L18 5" stroke="#333334" stroke-opacity="0.3" stroke-width="1.4"
              stroke-linecap="round" />
      </svg>
    </div>

    <ng-content>
      <div style="display: flex;
    flex-direction: column;
    width: 100%;
    align-items: center;" *ngIf="!popUpEntryService.confirmAuth && !popUpEntryService.accessVerification">
        <form [formGroup]="authForm" autocomplete="off" style="width: 100%;">
          <div class="input-group" style="    width: 100%;">
            <label for="email" class="text10opac05">Почта:</label>
            <input #formField
                   type="text"
                   id="email"
                   formControlName="email"
                   placeholder="Введите почту"
                   autocomplete="off"
                   [ngClass]="{'invalid': authForm.get('email')?.invalid && (authForm.get('email')?.dirty &&
                  isError || authForm.get('email')?.touched && isError)}">
            <div
              *ngIf="authForm.get('email')?.invalid && (authForm.get('email')?.dirty || authForm.get('email')?.touched)"
              class="error-message">
              <div *ngIf="authForm.get('email')?.errors?.['required']">почта обязательна для заполнения.</div>
            </div>
            <div *ngIf="authForm.get('email')?.errors?.['forbiddenWords']" class="error-message">
              Запрещённые слова: <span *ngFor="let word of authForm.get('email')?.errors?.['forbiddenWords']">{{
                word }},
              </span>
            </div>
            <p *ngIf="errorMessage" class="error-message">{{ errorMessage }}</p>
          </div>
          <a *ngIf="!telegramWidgetLoaded" class="popup-login-link" style="margin-top: 16px; width: 100%;"
             (click)="authUser()">
            @if (!popUpEntryService.isRegistration) {
              Войти
            } @else {
              Зарегистрироваться
            }
          </a>
        </form>
      </div>

      <div style="display: flex; flex-direction: column; gap: 3rem;"
           *ngIf="popUpEntryService.confirmAuth && !popUpEntryService.accessVerification">
        <div style="text-align: center;">Введите 6-значный код из письма</div>

        <div style="display: flex; justify-content: center; gap: 7px;">
          <input type="number" maxlength="1" class="code" style="width: 40px; text-align: center;"
                 (input)="moveFocus($event, 1)" #digit1>
          <input type="number" maxlength="1" class="code" style="width: 40px; text-align: center;"
                 (input)="moveFocus($event, 2)" (keydown.backspace)="moveFocus($event, 0, 'delete')" #digit2>
          <input type="number" maxlength="1" class="code" style="width: 40px; text-align: center;"
                 (input)="moveFocus($event, 3)" (keydown.backspace)="moveFocus($event, 1, 'delete')" #digit3>
          <input type="number" maxlength="1" class="code" style="width: 40px; text-align: center;"
                 (input)="moveFocus($event, 4)" (keydown.backspace)="moveFocus($event, 2, 'delete')" #digit4>
          <input type="number" maxlength="1" class="code" style="width: 40px; text-align: center;"
                 (input)="moveFocus($event, 5)" (keydown.backspace)="moveFocus($event, 3, 'delete')" #digit5>
          <input type="number" maxlength="1" class="code" style="width: 40px; text-align: center;"
                 (input)="moveFocus($event, 6)" (keydown.backspace)="moveFocus($event, 4, 'delete')" #digit6>
        </div>
        <div style="text-align: center; font-size: 14px; color: #666; margin-top: -2rem;">
          Письмо может попасть в папку «Спам» — проверьте её
        </div>
      </div>
    </ng-content>
  </div>
</div>
